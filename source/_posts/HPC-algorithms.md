---
title: HPCç®—æ³•
date: 2024-05-22 16:47:56
tags: HPC_Algorithms
categories: HPC_Algorithms
description: é«˜æ€§èƒ½è®¡ç®—ä¹¦ç±
keywords: æ€§èƒ½ä¼˜åŒ–ã€ç®—æ³•
top_img: https://s2.loli.net/2024/03/14/WQxHO96fkU5RJSe.jpg
cover: 
comments: false
---
# HPC Algorithm å›žé¡¾

> è¿™éƒ¨åˆ†åšå®¢ä¸»è¦æ˜¯å¯¹äºŽHPC Algorithmsçš„ä¹¦ç±å›žé¡¾ï¼Œè¿›è¡Œæ€»ç»“ï¼Œè¯¥éƒ¨åˆ†å†…å®¹å’Œæ€§èƒ½ä¼˜åŒ–å­¦ä¹ ç¬”è®°ç›¸å…³è”ï¼Œå†™è¿™ä¸ªç¬”è®°è®°å½•ä¸»è¦æ˜¯æ–¹ä¾¿å›žé¡¾ï¼Œå¦‚æžœæƒ³çœ‹ç»†èŠ‚å°±å›žåŽ»çœ‹[åŽŸæ–‡](https://en.algorithmica.org/hpc/)

------

## ç¬¬ä¸€ç« åˆ°ç¬¬äºŒç« 

![image-20240522190259128](https://s2.loli.net/2024/05/22/dHnJKeDz9tNUO7m.png)

ç¬¬ä¸€ç« çš„ç›®å½•å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸»è¦åŒ…æ‹¬ï¼š

1. ç»å…¸çš„è®¡ç®—å¤æ‚åº¦å®šä¹‰
2. åŒæºå¤æ‚åº¦ï¼ŒBIG O
3. æ‘©å°”å®šå¾‹çš„å¤±æ•ˆ
4. ä¸åŒç§ç±»çš„ç¼–ç¨‹è¯­è¨€

å…¶ä¸­ï¼Œå¯¹äºŽæ‘©å°”å®šå¾‹å¤±æ•ˆè¿™ä¸€ç« èŠ‚ï¼Œè®²äº†å…³äºŽå¦‚ä½•æ›´é«˜æ•ˆä½¿ç”¨æ›´å¤šçš„æ™¶ä½“ç®¡æ¥é©±åŠ¨è®¡ç®—æž¶æž„è®¾è®¡ï¼š

1. é‡å æ‰§è¡ŒæŒ‡ä»¤ï¼Œä½¿ CPU çš„ä¸åŒéƒ¨åˆ†ä¿æŒå¿™ç¢Œï¼ˆæµæ°´çº¿ï¼‰ï¼›
2. æ‰§è¡Œæ“ä½œæ—¶ä¸ä¸€å®šè¦ç­‰å¾…å‰ä¸€ä¸ªæ“ä½œå®Œæˆï¼ˆæŠ•æœºå’Œæ— åºæ‰§è¡Œï¼‰ï¼›
3. å¢žåŠ å¤šä¸ªæ‰§è¡Œå•å…ƒï¼ŒåŒæ—¶å¤„ç†ç‹¬ç«‹è¿ç®—ï¼ˆè¶…æ ‡é‡å¤„ç†å™¨ï¼‰ï¼›
4. å¢žåŠ æœºå™¨å­—çš„å¤§å°ï¼Œä»¥è‡³äºŽå¯ä»¥æ·»åŠ æŒ‡ä»¤ï¼Œå¯¹åˆ†æˆç»„çš„ 128ã€256 æˆ– 512 ä½æ•°æ®å—æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼ˆSIMDï¼‰ï¼›
5. åœ¨èŠ¯ç‰‡ä¸Šå¢žåŠ å¤šå±‚é«˜é€Ÿç¼“å­˜ï¼Œä»¥åŠ å¿« RAM å’Œå¤–éƒ¨å­˜å‚¨å™¨çš„è®¿é—®é€Ÿåº¦ï¼ˆå­˜å‚¨å™¨å¹¶ä¸å®Œå…¨éµå¾ªç¡…æ‰©å±•å®šå¾‹ï¼‰ï¼›
6. åœ¨èŠ¯ç‰‡ä¸Šå¢žåŠ å¤šä¸ªç›¸åŒçš„å†…æ ¸ï¼ˆå¹¶è¡Œè®¡ç®—ã€å›¾å½¢å¤„ç†å™¨ï¼‰ï¼›
7. åœ¨ä¸»æ¿ä¸Šä½¿ç”¨å¤šä¸ªèŠ¯ç‰‡ï¼Œåœ¨æ•°æ®ä¸­å¿ƒä½¿ç”¨å¤šå°æ›´ä¾¿å®œçš„è®¡ç®—æœºï¼ˆåˆ†å¸ƒå¼è®¡ç®—ï¼‰ï¼›
8. ä½¿ç”¨å®šåˆ¶ç¡¬ä»¶è§£å†³ç‰¹å®šé—®é¢˜ï¼Œæé«˜èŠ¯ç‰‡åˆ©ç”¨çŽ‡ï¼ˆASICã€FPGAï¼‰ã€‚



è€Œå¯¹äºŽç¬¬äºŒç« çš„å†…å®¹ï¼Œä¸»è¦è®²çš„æ˜¯è®¡ç®—æœºæž¶æž„ï¼Œä¸»è¦ç›®å½•ç»“æž„å¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20240522191219446](https://s2.loli.net/2024/05/22/Ho4WQFavyJCYE8p.png)

**ç¬¬ä¸€ä¸ªå†…å®¹**è®²çš„æ˜¯ISAï¼Œå¤§æ¦‚è®²äº†RISCå’ŒCISCï¼Œå…¶ä¸­ARMæ˜¯RISCï¼Œè€Œx86æ˜¯CISCã€‚ï¼ˆCISCèƒ½å¤Ÿå®žçŽ°æ›´å¤šçš„å¤æ‚çš„ç‰¹æ®Šçš„æŒ‡ä»¤ï¼Œè€ŒRISCè¦åŽ»å®žçŽ°å°±éœ€è¦ç”¨å­ç¨‹åºå®žçŽ°ï¼‰ã€‚ç›®å‰çš„X86æž¶æž„åŸºæœ¬ä¸Šè¢«ä¸¤å®¶å…¬å¸æŽ§åˆ¶ï¼ŒIntelå’ŒAMDï¼Œè€ŒARMæž¶æž„åˆ™æ˜¯è¢«ARMå…¬å¸æŽ§åˆ¶ï¼ŒARMæž¶æž„çš„ä¼˜åŠ¿åœ¨äºŽä½ŽåŠŸè€—ï¼Œè€ŒX86æž¶æž„çš„ä¼˜åŠ¿åœ¨äºŽé«˜æ€§èƒ½ã€‚

**ç¬¬äºŒä¸ªå†…å®¹**è®²çš„æ˜¯æ±‡ç¼–è¯­è¨€ï¼Œè¿™éƒ¨åˆ†æ²¡ä»€ä¹ˆå¥½è®²çš„ï¼Œå°±æ˜¯è®²äº†ä¸€äº›åŸºæœ¬çš„æ±‡ç¼–è¯­è¨€çš„çŸ¥è¯†ã€‚

**ç¬¬ä¸‰ä¸ªã€ç¬¬å››ä¸ªå†…å®¹**è®²çš„æ˜¯å¾ªçŽ¯ã€æ¡ä»¶ã€å‡½æ•°ä»¥åŠé€’å½’ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯å°†è¿™äº›å’Œæ±‡ç¼–è¯­è¨€è”ç³»èµ·æ¥ï¼Œå…¶ä¸­ä¸ä¹åŒ…æ‹¬å¾ªçŽ¯å±•å¼€ï¼Œè·³è½¬ç­‰æŠ€å·§ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬å¯¹äºŽè·³è½¬ï¼Œå¯ä»¥ä¸æ˜¾å¼åœ°ä½¿ç”¨è·³è½¬æŒ‡ä»¤ï¼Œè€Œæ˜¯é€šè¿‡æ¡ä»¶åˆ¤æ–­æ¥å®žçŽ°è·³è½¬ï¼Œä¸è¿‡æ˜¯é€šè¿‡å…¶å®ƒæŒ‡ä»¤ä¿®æ”¹çš„FLAGSå¯„å­˜å™¨æ¥å®žçŽ°çš„ã€‚è€Œå¯¹äºŽå‡½æ•°ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªæ ˆçš„é—®é¢˜ï¼Œå‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šå°†å‚æ•°åŽ‹å…¥æ ˆä¸­ï¼Œç„¶åŽè°ƒç”¨å‡½æ•°ï¼Œå‡½æ•°è¿”å›žçš„æ—¶å€™ï¼Œä¼šå°†è¿”å›žå€¼åŽ‹å…¥æ ˆä¸­ï¼Œç„¶åŽè¿”å›žï¼Œè¿™æ ·å°±å¯ä»¥å®žçŽ°å‡½æ•°çš„è°ƒç”¨ã€‚å¹¶ä¸”**å¤„ç†å‡½æ•°è°ƒç”¨çš„æœ€ä½³æ–¹æ³•å°±æ˜¯é¿å…å‡½æ•°è°ƒç”¨**ï¼Œå› ä¸ºå‡½æ•°è°ƒç”¨ä¼šæœ‰ä¸€å®šçš„å¼€é”€ã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡**Inliningçš„æ–¹æ³•**åŽ»è§£å†³Callerå’ŒCalleeä¹‹é—´ä½¿ç”¨å¯„å­˜å™¨å†²çªçš„é—®é¢˜ã€‚

ä½†æ˜¯å¯¹äºŽå†…è”å‡½æ•°ï¼Œå¹¶ä¸é€‚ç”¨äºŽé€’å½’å‡½æ•°ï¼Œå› ä¸ºé€’å½’å‡½æ•°ä¼šæœ‰å¾ˆå¤šçš„è°ƒç”¨ï¼Œå¦‚æžœå†…è”çš„è¯ï¼Œä¼šå¯¼è‡´æ ˆç©ºé—´çš„æ¶ˆè€—è¿‡å¤§ï¼Œæ‰€ä»¥é€’å½’å‡½æ•°ä¸é€‚åˆå†…è”ã€‚è¿™é‡Œè¿˜å®šä¹‰äº†å¦‚æžœé€’å½’ä¹‹åŽç›´æŽ¥è¿”å›žï¼Œé‚£ä¹ˆè¿™ä¸ªé€’å½’å°±æ˜¯å°¾é€’å½’ï¼Œå°¾é€’å½’å¯ä»¥é€šè¿‡å¾ªçŽ¯æ¥å®žçŽ°ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æ ˆç©ºé—´çš„æ¶ˆè€—ã€‚

**ç¬¬äº”ä¸ªå†…å®¹**è®²çš„æ˜¯é—´æŽ¥çš„åˆ†æ”¯ï¼Œå…¶ä¸­ä¸€ç§å°±æ˜¯switch-caseæƒ…å†µï¼Œå¦ä¸€ç§å°±æ˜¯å¸¸è§çš„åŠ¨æ€åˆ†æ”¯ï¼Œæ¯”å¦‚è™šå‡½æ•°çš„å®žçŽ°ã€‚ä¸ºäº†æ­£ç¡®å®žçŽ°è°ƒç”¨è™šå‡½æ•°ï¼Œæ¯”å¦‚æˆ‘æœ‰ä¸€ä¸ªåŠ¨ç‰©çš„è™šç±»ï¼Œç„¶åŽæœ‰ä¸€ä¸ªç‹—ç±»ç»§æ‰¿äº†åŠ¨ç‰©ç±»ï¼Œé‚£ä¹ˆæˆ‘åœ¨è°ƒç”¨åŠ¨ç‰©ç±»çš„æ—¶å€™ï¼Œå®žé™…ä¸Šæ˜¯è°ƒç”¨ç‹—ç±»çš„å‡½æ•°ï¼Œè¿™å°±æ˜¯åŠ¨æ€åˆ†æ”¯çš„å®žçŽ°ã€‚è€Œå¯¹äºŽè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡**è™šå‡½æ•°è¡¨**æ¥å®žçŽ°ï¼Œè™šå‡½æ•°è¡¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ï¼Œé‡Œé¢å­˜æ”¾çš„æ˜¯è™šå‡½æ•°çš„åœ°å€ï¼Œç„¶åŽåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œé€šè¿‡è™šå‡½æ•°è¡¨æ¥è°ƒç”¨å‡½æ•°ã€‚ä½†æ˜¯ä¼šé‡åˆ°é—®é¢˜ï¼špipeline flushingï¼Œè¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨è°ƒç”¨è™šå‡½æ•°çš„æ—¶å€™ï¼Œä¼šå¯¼è‡´æµæ°´çº¿çš„åˆ·æ–°ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚å®žé™…ä¸Šå¯¹äºŽè¿è¡Œæ—¶å¤šæ€ï¼Œæœ€å¥½çš„æ–¹æ³•å°±æ˜¯**é¿å…è¿è¡Œæ—¶å¤šæ€**ï¼Œå› ä¸ºè¿è¡Œæ—¶å¤šæ€ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚ (æ„Ÿè§‰è¯´äº†ç­‰äºŽç™½è¯´å•Šå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ ðŸ¤£)

**ç¬¬å…­ä¸ªå†…å®¹**æ¯”è¾ƒæœ‰æ„æ€ï¼Œ ðŸ˜Žæ˜¯å…³äºŽæœºå™¨ç çš„Layoutï¼Œå®žé™…ä¸Šï¼Œæ‰€æœ‰çš„æ€§èƒ½ä¼˜åŒ–ï¼Œåœ¨æœ€åŽéƒ½ä¼šè½¬åŒ–ä¸ºæœºå™¨ç ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦äº†è§£æœºå™¨ç çš„å¸ƒå±€ï¼Œè¿™æ ·æ‰èƒ½æ›´å¥½åœ°è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚æœºå™¨ç åœ¨å†…å­˜ä¸­çš„å¸ƒå±€ä¼šä»¥ä¸€ç§å¥‡æ€ªçš„æ–¹å¼å½±å“æ€§èƒ½ï¼Œæ¯”å¦‚è¯´æˆ‘ç§»é™¤æŽ‰æ²¡ç”¨çš„ä»£ç ã€äº¤æ¢ifç”šè‡³æ”¹å˜å‡½æ•°å‚æ•°çš„é¡ºåºï¼Œéƒ½ä¼šæ˜¯çš„æ€§èƒ½å‘ç”Ÿæé«˜æˆ–è€…å˜å·®ã€‚

ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„ä¾‹å­å°±æ˜¯ï¼ŒInlineå¹¶ä¸ä¸€å®šéƒ½å¾ˆæœ‰æ•ˆï¼Œè¿™å°±æ¶‰åŠInstruction Cacheï¼Œå¦‚æžœInlineçš„å‡½æ•°å¤ªå¤§ï¼Œé‚£ä¹ˆä¼šå¯¼è‡´Instruction Cacheçš„å‘½ä¸­çŽ‡ä¸‹é™ï¼Œä»Žè€Œå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚æ‰€ä»¥Inlineå¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼Œè€Œæ˜¯è¦æ ¹æ®å®žé™…æƒ…å†µæ¥å†³å®šã€‚è€Œå¯¹äºŽå±•å¼€å¾ªçŽ¯äº¦æ˜¯å¦‚æ­¤ï¼ŒCPUåœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ¬¡æ€§å–å¤ªå¤šçš„æŒ‡ä»¤ï¼Œä¼šå¯¼è‡´Instruction Cacheçš„å‘½ä¸­çŽ‡ä¸‹é™ï¼Œä»Žè€Œå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ã€‚ï¼ˆä¸è¿‡å¤§çš„ä»£ç å¯¹é½è™½ç„¶ä¼šéœ€è¦æ›´å¤šçš„æŒ‡ä»¤ç¼“å­˜ï¼Œä½†æ˜¯ä¹Ÿè¦æ¯”ç¼“å­˜å‘½ä¸­çŽ‡ä¸‹é™å¥½ï¼‰

> æˆ‘ä»¬æ€»æ˜¯ä¹ æƒ¯æ€§çš„ä½¿ç”¨å‰äººç»™çš„å»ºè®®ï¼Œå®žé™…ä¸Šæˆ‘ä»¬ä¸æ¸…æ¥šä¸ºä»€ä¹ˆå¥½ç”¨ï¼Œä»¥åŠä»€ä¹ˆæƒ…å†µä¸‹å¥½ç”¨ï¼Œå°±æ¯”å¦‚è¿™ä¸ªInline ðŸ˜Ÿ

å…¶ä¸­ï¼Œå¯¹äºŽä¸å‡ç­‰çš„åˆ†æ”¯é—®é¢˜ï¼Œä¹¦ä¸­åšäº†è¯¦ç»†çš„è¯´æ˜Žï¼Œå°½ç®¡åœ¨Cè¯­è¨€çš„è§’åº¦çœ‹ä¸€ä¸ªç®€å•çš„è®¡ç®—å·®å€¼å‡½æ•°æ˜¯å¯¹ç§°çš„ï¼Œä½†æ˜¯åœ¨æ±‡ç¼–é‡Œé¢å¹¶ä¸æ˜¯ï¼š

```c
int length(int x, int y) {
    if(x>y)
    	return x - y;
    else
    	return y - x;
}
```

```assembly
length:
    cmp  edi, esi
    jle  less
    ; x > y
    sub  edi, esi
    mov  eax, edi
done:
    ret
less:
    ; x <= y
    sub  esi, edi
    mov  eax, esi
    jmp  done
```

æˆ‘ä»¬å¯ä»¥å‘çŽ°ï¼Œå®žé™…ä¸Šä¸åŒçš„åˆ†æ”¯èŠ±è´¹çš„æŒ‡ä»¤æ•°ç›®æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å°±æ˜¯ä¸å‡ç­‰çš„åˆ†æ”¯é—®é¢˜ï¼Œè¿™ä¸ªé—®é¢˜ä¼šå¯¼è‡´æ€§èƒ½çš„ä¸‹é™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½é‡é¿å…ä¸å‡ç­‰çš„åˆ†æ”¯ã€‚

é‚£ä¹ˆå¦‚æžœæˆ‘ä»¬è€ƒè™‘è¿›è¡Œxchg(exchange),é‚£ä¹ˆå‡½æ•°çš„å‚æ•°é¡ºåºå°±æ¯”è¾ƒé‡è¦ï¼ŒåŒç†å¦‚æžœæˆ‘ä»¬ç»™ç¼–è¯‘å™¨ä¸€ä¸ªhintæç¤ºå“ªä¸ªè·¯å¾„æ˜¯ä¸ç»å¸¸çš„ï¼Œé‚£ä¹ˆå‡½æ•°å‚æ•°é¡ºåºä¾æ—§å¾ˆé‡è¦ã€‚å®žé™…ä¸Šï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•å°±æ˜¯ç±»ä¼¼Cè¯­è¨€ä¸‰å…ƒç»„çš„å½¢å¼æ¥å®žçŽ°ï¼š`(x > y ? y - x : x - y)` or calling `abs(x - y)`:

```assembly
length:
    mov   edx, edi
    mov   eax, esi
    sub   edx, esi
    sub   eax, edi
    cmp   edi, esi
    cmovg eax, edx  ; "mov if edi > esi"
    ret
```

